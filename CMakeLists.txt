cmake_minimum_required(VERSION 3.12 FATAL_ERROR)
project(Eon LANGUAGES CXX)
set(VERSION "0.1.1")
message(STATUS "Eon C++ v${VERSION}")

# Configuration
set(EON_SOURCES_DIR "${CMAKE_CURRENT_SOURCE_DIR}" CACHE PATH "The directory containing the source files")
set(EON_INSTALL_DIR "${CMAKE_INSTALL_PREFIX}" CACHE PATH "Where to install")
set(EON_BINARY_DIR "bin" CACHE STRING "Where to install binaries under EON_INSTALL_DIR")
set(EON_LIBRARY_DIR "lib" CACHE STRING "Where to install libraries under EON_INSTALL_DIR")
set(EON_INCLUDE_DIR "include" CACHE STRING "Where to install headers under EON_INSTALL_DIR")
set(EON_TESTS_DIR "eontests" CACHE PATH "Where to install tests under EON_INSTALL_DIR")
set(CMAKE_DEBUG_POSTFIX "_d" CACHE STRING "Postfix to debug builds")

set(EON_BUILD_TESTS ON CACHE BOOL "Include tests in build?")
set(EON_INLINE_TESTS OFF CACHE BOOL "Include inline unit tests in build?")
set(EON_BUILD_FILESYS ON CACHE BOOL "Include the File System package")
set(EON_BUILD_EDT OFF CACHE BOOL "Build the Eon Data Tuple package")
set(EON_BUILD_EDOC OFF CACHE BOOL "Build the Eon Documentation package")
set(EON_BUILD_TOKENIZER OFF CACHE BOOL "Build the Tokenizer package")
set(EON_BUILD_PARSER OFF CACHE BOOL "Build the Eon Parser package")
set(EON_BUILD_EONEDOCGEN OFF CACHE BOOL "Build the Eon Document Generator")

if(CMAKE_BUILD_TYPE STREQUAL "Debug")
	add_definitions(-D_DEBUG)
endif()
set(CMAKE_CXX_STANDARD 17)
add_definitions(-D_SILENCE_CXX17_CODECVT_HEADER_DEPRECATION_WARNING)

if(EON_BUILD_TESTS)
	add_subdirectory(eontest)
endif()
if(EON_INLINE_TESTS)
	add_definitions( -DEON_INLINE_TEST )
endif()
add_subdirectory(eoninlinetest)
add_subdirectory(eonterminal)
add_subdirectory(eonstack)
add_subdirectory(eonstring)
add_subdirectory(eonexcept)
add_subdirectory(eonregex)
add_subdirectory(eonsource)
if(EON_BUILD_FILESYS)
	add_subdirectory(eonfilesys)
endif()
if(EON_BUILD_TOKENIZER OR EON_BUILD_PARSER OR EON_BUILD_EDT OR EON_BUILD_EONEDOCGEN)
	add_subdirectory(eontokenizer)
endif()
if(EON_BUILD_TOKENIZER OR EON_BUILD_PARSER OR EON_BUILD_EDT OR EON_BUILD_EDOC)
	add_subdirectory(eontypes)
endif()
if(EON_BUILD_EDOC OR EON_BUILD_EONEDOCGEN)
	add_subdirectory(eonedoc)
endif()
if(EON_BUILD_EONEDOCGEN)
	add_subdirectory(eonedocgen)
endif()
if(EON_BUILD_EDT OR EON_BUILD_EONEDOCGEN)
	add_subdirectory(eonedt)
endif()
if(EON_BUILD_PARSER OR EON_BUILD_EDT OR EON_BUILD_EONEDOCGEN)
	add_subdirectory(eonparser)
endif()
